spring: "1.0"

name: Cal.com
description: Open source Calendly successor - scheduling infrastructure for everyone

prerequisites:
  - name: Node.js
    check: node --version
    required: true
  - name: Yarn
    check: yarn --version
    required: true
  - name: Docker
    check: docker --version
    required: true

steps:
  - name: Install dependencies
    run: yarn install
  - name: Copy environment file
    run: cp .env.example .env
  - name: Generate NextAuth secret
    run: NEXTAUTH_SECRET=$(openssl rand -base64 32) && sed -i "" "s|^NEXTAUTH_SECRET=.*|NEXTAUTH_SECRET=$NEXTAUTH_SECRET|" .env
  - name: Generate encryption key
    run: CALENDSO_ENCRYPTION_KEY=$(openssl rand -base64 32) && sed -i "" "s|^CALENDSO_ENCRYPTION_KEY=.*|CALENDSO_ENCRYPTION_KEY=$CALENDSO_ENCRYPTION_KEY|" .env
  - name: Start development environment with database
    run: yarn dx
    background: true
    ready_when:
      type: http
      url: http://localhost:3000
      timeout: 600s
